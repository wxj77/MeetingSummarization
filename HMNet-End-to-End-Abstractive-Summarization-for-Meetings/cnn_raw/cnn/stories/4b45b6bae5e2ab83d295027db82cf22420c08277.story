(CNN) -- San Diego Mayor Bob Filner is resigning in the face of a torrent of sexual harassment claims -- though he's not going out quietly.

City Attorney Jan Goldsmith announced around 3:45 p.m. (6:45 p.m. ET) that the City Council, during a closed-door session, had accepted the terms of an agreement with Filner that was reached after three days of mediation talks.

Filner submitted a "signed resignation" that "the city has accepted" in a 7-0 vote by council members, Goldsmith said. That resignation will take effect at 5 p.m. Friday, August 30.

After that vote, Filner spoke at the City Council meeting -- his first extensive public comments in weeks -- and began by offering a "deep apology ... to all the citizens."

"The city should not have been put through this," the 70-year-old mayor said. "And my own personal failures were responsible."

A short time later, though, Filner went on the defensive. While admitting that his behavior toward women was inappropriate at times, he insisted that he "never sexually harassed anyone."

In the process of "trying to establish personal relationships," the mayor explained, "the combination of awkwardness and hubris, I think, led to behavior that many found offensive." He added, "Not one allegation ... has ever been independently verified or proven in court."

"But the hysteria that has been created ... is the hysteria of a lynch mob," Filner said, criticizing an environment in which "rumors become allegations, allegations become facts, facts become evidence of sexual harassment which have led to demands for my resignation and recall."

Blasting politicians and members of the media who "unleashed a monster," the mayor said, "The hysteria ended up playing into the hands of those who wanted a political coup -- the removal of a democratically elected mayor purely by rumor and innuendo."

"They found the weapons they needed in my own failures as a human being," Filner said of "well-organized interests" opposed to him. "But they found with those weapons and they used them, in a bloody and vicious way."

The outgoing mayor's remarks -- going from a contrite apology to a withering attack -- left many watching from inside City Hall stunned, according to a source who was there. The comment about his being the victim of a "coup" especially caught people off guard.

"We are shocked that he would go there," said the source inside City Hall.

This defiant stance notwithstanding, it doesn't change the fact that Filner's term as mayor ends -- according to a deal he agreed to -- next week.

And when it does, City Council President Todd Gloria will step in on an interim basis. Gloria said Friday afternoon, after the council session, that he'll soon begin work on setting up a special election.

Speaking shortly after Filner, Gloria -- who, along with the other eight council members, had demanded Filner's resignation -- said that he believes the "settlement represents an end to our civil nightmare, and it allows our city to begin to heal."

"San Diego is back," the incoming interim mayor said later. "We are America's greatest city, and we always will be."

The agreement signed off on Friday does not affect a lawsuit brought against Filner by Irene McCormack Jackson, the mayor's former communications chief, according to Goldsmith.

Jackson left her job when she sued the mayor in July -- saying he had subjected women to "crude and disgusting" comments and inappropriate touching -- but remains a municipal employee, Goldsmith noted. He said Friday that the city will continue to engage in mediation talks with Jackson and her lawyer, Gloria Allred.

Under the mediation agreement, San Diego will dismiss its cross-complaint against Filner in relation to that lawsuit, the city attorney said.

Meet Filner's accusers

Goldsmith also said that, for any claims brought against San Diego and Filner for his alleged conduct while mayor, "the city will provide a joint legal defense through the city attorney's office for the city and Mr. Filner."

Friday's announcement marks the latest milestone in a saga that has gripped San Diego for seven weeks, when the first in what would be 18 women came forward publicly to accuse Filner -- during his time as congressman and, since 2012, as mayor -- of inappropriate behavior.

Numerous public officials, including all nine city council members and the state's two U.S. Senators, urged Filner to step down. So, too, did a majority of locals, according to polls.

Some of them voiced that view to city council members Friday, before they convened in private session to make their decision on the agreement.

Other speakers also rose to support Filner.

Scott Andrews claimed "everything but due process has occurred," while one woman called what's happening "a circus to get a good man out of office."

A few offered sympathy for the council members, given what they and other municipal leaders have dealt with in recent weeks and the decision that lay ahead.

"It is really about the city that we all love," said Laurie Black, a longtime civic leader. "And make your decision with the intentions of loving your city."

Even once Filner leaves office, the city could bear the repercussions of his alleged behavior.

As Goldsmith noted, the city can be held liable for the actions of its employees -- including its past and present mayor.

Filner, himself, is hardly out of the woods. While he now only faces one lawsuit, others could follow.

Plus, there's the chance that the congressman-turned-mayor could be prosecuted by local, state or federal authorities.

Speaking to that point after news of the resignation became official, California Attorney General's office spokesman Nick Pacilio said, "We can confirm a criminal investigation is underway."

Did mayor target victims of military sexual assault?

Opinion: Will 'Mayor Naughty' please step down?

CNN's Kyung Lah, Ed Payne, Tom Watkins and Casey Wian contributed to this report.

@highlight

NEW: Filner says he was forced out due to a "coup" based on "rumor and innuendo"

@highlight

NEW: His remarks left people inside City Hall stunned, a source says

@highlight

NEW: Council president says the deal " allows our city to begin to heal"

@highlight

18 women have publicly accused Filner of sexual harassment; 1 has sued