Two weeks before a bloody shooting rampage that killed 12 people at an Aurora, Colorado, movie theater, suspect James Holmes apparently visited the cinema and took photographs of hallways and doors, a police detective testified on Wednesday.

Holmes returned nine days before the massacre, Sgt. Matthew Fyles testified at the the conclusion of a preliminary court hearing, and took pictures of exterior doors.

The photographs were recovered from Holmes' cell phone and go along with months of sales records and descriptions of meticulously prepared booby traps at his home. It all helps illustrate what would appear to be a well-planned attack.

"He didn't care who he killed," prosecutor Karen Pearson told the judge at the conclusion of her case against Holmes, saying he chose his venue carefully to cage his victims. "He intended to kill them all."

Read more: New details emerge at hearing

The former neuroscience graduate student is charged with 166 counts of murder, attempted murder and weapons violations in the July 20 shooting that killed 12 and wounded 58.

Arapahoe County District Judge William Sylvester said he would rule on Friday whether authorities presented enough evidence during the three-day hearing to proceed to trial.

Defense attorneys, who had been expected to call witnesses and argue a diminished capacity defense, changed their minds during the hearing, attorney Dan King said.

"We have had a change of position," he said. "This is neither the proper venue nor the time to put on a show or present some truncated defense."

After the hearing, some of the victims' relatives asserted that Holmes was too calculating to be afflicted with diminished capacity.

"He's not crazy one bit," Tom Teves told reporters Wednesday. His son Alex, 24, was among those killed.

"He's very, very cold. He's very, very calculated," Teves said of Holmes. "He has a brain set that no one here can understand, and we want to call him crazy because we want to make that feel better in our society.

"But we have to accept the fact there is evil people in our society that enjoy killing any type of living thing. That doesn't make him crazy," Teves said.

Added Jessica Watts, cousin of Jonathan Blunk, also killed in the theater: "It was complete planning. It was competency. It was everything on his part to make sure that this act was carried out from start to finish."

Before wrapping up, prosecutors asked Fyles to display other photos taken from Holmes' phone, including shots of improvised explosives under construction in his kitchen on July 16 and disturbing images of the suspect, his red hair curling out from beneath the black watch cap prosecutors say he wore to the theater.

In one image, he is sticking out his tongue and wearing contact lenses that render his eyes utterly black. In another, he holds a firework that resembles the spherical bombs so prevalent in cartoons. He appears to be whistling in the photo.

The pictures were taken July 19, the same day authorities say Holmes headed to the theater to begin his rampage shortly after midnight on July 20.

Holmes could be seen smiling slightly as the photographs were displayed.

According to hearing testimony, here is what is known about his alleged preparations:

Getting ready

Holmes began buying guns in May, supervisory agent Steve Beggs of the Bureau of Alcohol, Tobacco, Firearms and Explosives testified on Tuesday. Beggs said he built an arsenal of two Glock handguns, an AR-15 rifle, a shotgun and 6,295 rounds of ammunition.

Among other purchases, Beggs said Holmes bought two 6-ounce tear gas grenades over the Internet on May 10 and he went to a gun store on May 22 to buy one of his Glocks.

A little more than a month later, on July 1, a video camera captured Holmes as he bought a scope, a mount and some inert ammunition at a Colorado gun store, Beggs said.

In the video, Beggs said, Holmes' hair is dyed bright orange.

Four days later -- July 5 -- Holmes apparently visited the theater and used his iPhone to take pictures of interior doorways, Fyles testified

On July 7, Holmes used an online ticketing service to buy a ticket for the midnight showing of the movie, according to Detective Craig Appel, the lead investigator in the case.

He then returned to the theater two days later to take pictures of exterior doorways, Fyles testified.

Read more: Remembering the victims

The apartment

Witnesses detailed preparations that prosecutors believe Holmes made before setting out for the theater to turn his sparsely decorated Aurora apartment into a deathtrap.

At least some of the preparations were well under way by July 16, based on a photograph from Holmes' phone shown by prosecutors. In it, jars, wires, firework shells and other bomb-making materials are laid out in his kitchen.

By the time Holmes left, the carpet in his apartment had been soaked in oil and gas, FBI bomb technician Garrett Gumbinner testified. A container of glycerin hung above a frying pan with a potassium mixture, attached to a trip wire that would tip the glycerin into the pan, Gumbinner testified.

If triggered, Gumbinner said it would have set off an explosion and fire, igniting jars of homemade napalm spiked with bullets and thermite -- a metallic substance that burns so hot it is nearly impossible to extinguish.

In a diabolical twist that seems ripped from the pages of a comic book, witnesses said Holmes also rigged his computer and a boom box placed outside to begin playing loud music after he set out for the theater -- apparently in hopes that the noise would prompt someone to investigate and trigger the explosives.

Next to the boom box outside his apartment, Gumbinner testified, Holmes said he placed a toy car and a device that looked like it would control the car but would in fact set off the explosives.

Authorities recovered the boom box, bearing Holmes' fingerprints. The remote-control car device was never found, Appel testified.

A series of disturbing self-portraits displayed in court, apparently made sometime before Holmes allegedly left for the theater, according to data retrieved from his phone, show him in the eye-blackening contacts, his tongue stuck out in one, flashing a toothy grin and a handgun in another.

The shooting

Video from the theater shows a man they say is Holmes -- wearing dark pants, a light-colored shirt and a dark stocking cap covering his orange hair -- entering the multiplex before the movie begins.

The recordings show him going into Theater No. 9, a different theater from the one listed on his ticket.

While witnesses have not detailed in this week's preliminary hearing what investigators believe Holmes did once inside the theater, sources have said they believe he propped open the theater's back door and went to his car to put on body armor and arm himself. Authorities believe Holmes then re-entered the theater, tossing gas canisters before opening fire about 18 minutes into the movie, according to sources.

Witnesses who have spoken to CNN about the shooting have said the gunman roamed the theater, shooting people randomly as they tried to scramble away or cowered between seats.

Aurora survivors: How they're doing

Among the 41 calls to 911, one stands out. In the 27-second call, the sounds of at least 30 shots ring out amid the chaos.

At some point, according to Pearson, one of Holmes' weapons jammed.

"Had the AR-15 not jammed, he would have killed more people," she said.

Investigators found 76 shell casings in the auditorium. Most of the spent rounds -- 65 -- were .223 caliber rifle rounds, six were shotgun shells and five were .40 caliber rounds from the Glocks, Appel said. Police also found one of the tear-gas canisters inside the theater, Appel said.

Also located was a large drum magazine for the rifle that appeared to have jammed, Sgt. Gerald Jonsgaard testified Monday.

The rifle cartridges were steel-core rounds, which are more likely to pass through a body intact and can cause multiple wounds, Fyles testified.

The movie theater's video system didn't capture anything from inside the theater but did capture the aftermath -- streams of terrified patrons running from the theater.

On Monday, police who were first to arrive described an eerie scene, stepping into a movie theater with "Batman" still blaring from the screen, blood from badly wounded victims flowing in the aisles and cell phones ringing over and over again, without answer.

Outside, the first officer to encounter Holmes -- who was still dressed in body armor, a helmet and a gas mask as he stood near his car -- described him as unnaturally relaxed.  In fact, from Holmes' appearance, Officer Jason Oviatt thought he was a fellow police officer.

A trail of blood led from the theater. The rifle that authorities believe Holmes used in the attack lay on the ground near the building. Holmes was just standing there, Oviatt testified Monday.

"He seemed very detached from it all," Oviatt said.

Holmes, his pupils dilated, sweating and smelly, didn't struggle or even tense his muscles as he was dragged away to be searched, Oviatt said.

Police would cut off the body armor he wore and learn from him about the explosive booby-trap at his home.

The interrogation

Police described a strange scene in the interrogation room -- Holmes sitting in his underwear, T-shirt and white socks after police had had cut away his body armor -- making puppets of the paper bags officers had placed over his hands to preserve gunpowder evidence, according to Appel.

Holmes played with his polystyrene drinking cup as if it were a piece in a game. Appel said. Then he removed a staple from the table and tried to stick it in an electrical outlet, the detective testified.

Asked by a defense attorney whether he had ordered a blood test for Holmes, Appel said he had not.

"There were no indications that he was under the influence of anything," he said.

Read more: University releases e-mails related to Colorado theater shooting suspect

@highlight

"He's not crazy one bit," says father whose son was killed in theater

@highlight

Gunman made sure "this act was carried out from start to finish," victim's relative says

@highlight

James Holmes "didn't care who he killed," prosecutor says

@highlight

Judge will rule Friday on whether case can proceed to trial