(CNN) -- Marc Marquez tied the 1997 record of Australian legend Mick Doohan for most wins in a MotoGP season with victory Sunday in a thrilling Malaysian Grand Prix.

It was the 12th win of the season for Repsol Honda's Marquez, who has already wrapped up his second straight world title.

He had a race long battle with the Movistar Yamaha pair of Valentino Rossi and Jorge Lorenzo, who completed the podium in Sepang.

The 21-year-old Marquez slipped to as low as ninth after a poor start from pole, but the Spaniard quickly worked his way back through the field, taking the lead for good on the 11th lap.

Rossi, who won last week in Australia after Marquez crashed out, tracked him for the remainder of the race but finished 2.445 seconds adrift at the checkered flag.

Italian legend Rossi has a 12-point advantage over his teammate Lorenzo in the battle for second place in the championship, heading into the final round in Valencia.

Marquez will get the chance to beat Doohan's record on home soil and it is a prospect which thrills him.

"I've equaled Mick Doohan's record, with one race left maybe I can beat it," he told the official MotoGP website.

"If I had a bad result here the pressure in Valencia would be more. But now I am free in Valencia and I can do well for my fans and just enjoy it," he added.

Marquez's teammate, Dani Pedrosa, saw his hopes ended by going off twice and he could not complete the race.

The leading three were followed home, at some distance, by Germany's Stefan Bradl on a Honda and young British rider Bradley Smith on a Yamaha Tech 3.

Smith's teammate, Pol Espargaro of Spain, came in sixth despite breaking a bone in his left foot in a fall during practice Saturday.

Meanwhile, in the world rallying championship, Sebastien Ogier of France retained his global title with victory in the Rally of Spain Sunday.

Ogier took the honors ahead of Volkswagen teammate Jari-Mari Latvala of Finland, the only man who could have denied him the title.

Another Finn, Mikko Hirvonen, in a Ford Fiesta RS, was third.

It was the seventh win in 12 rounds for the 30-year-old Ogier, who is only the fifth driver to achieve back-to-back title triumphs.

@highlight

Marc Marquez wins Malaysian MotoGP in Sepang

@highlight

12th win of season for two-time world champion

@highlight

Ties all-time record held by Mick Doohan of Australia from 1997

@highlight

Sebastien Ogier clinches world rally title with victory in Spain