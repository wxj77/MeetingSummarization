(CNN) -- Cristiano Ronaldo's stunning extra-time header gave Jose Mourinho his first trophy as Real Madrid coach on Wednesday, winning the Spanish Cup final 1-0 against arch-rivals Barcelona.

Real went to Valencia seeking a first Copa del Rey triumph since 1993, and the 42nd goal this season by the world's most expensive player handed the club an 18th success in the competition.

The Portugal captain rose high at the far post to power in a 103rd-minute effort from a teasing cross by Angel Di Maria, who was sent off for a second booking at the end of the second spell of extra time.

It was Ronaldo's second goal in two games against Barca, having netted a late equalizing penalty in Saturday's 1-1 draw that left the Catalans eight points clear in La Liga.

Is Real Madrid's Mourinho the master of mind games?

Mourinho employed the defensive midfield formation he used in that second "El Clasico" clash this season between the two teams, who will meet again in the semifinals of the European Champions League next Wednesday.

The tactic paid off as Real had the better of the first half of regulation play, and converted midfielder Pepe came closest to breaking the deadlock with a thumping header that hit the post in the 44th minute.

Barcelona battled back into the game in the second half, and had the ball in the net with 69 minutes gone but Pedro was ruled to have been marginally offside as he gathered a superb pass from Lionel Messi.

Captain Iker Casillas then saved Real with superb efforts to deny Messi and Pedro in rapid succession, and the match went to extra time.

Ten-man Madrid deny Barcelona in Clasico

Madrid waited for counter-attacking opportunities, and the first came in the 98th minute as Ronaldo raced clear before driving just wide of Jose Manuel Pinto's far post.

But he made no mistake five minutes later as Di Maria combined well down the left with Marcelo and delivered the perfect cross.

The Argentine departed the scene in time added on, but Barcelona did not make anything of the resulting free-kick and Pep Guardiola's team -- seeking an overall 26th triumph -- could not force a penalty shootout.

It gave Mourinho his first victory over Barca since taking charge at Real, and went some way to avenging the 5-0 thrashing at the Nou Camp in the first half of the season.

He has now won a trophy in every country in which he has coached -- his native Portugal, England, Italy and now Spain.

Meanwhile, AC Milan had to come from behind to secure a 2-2 draw at home to Palermo in the first leg of their Coppa Italia semifinal on Wednesday.

Zlatan Ibrahimovic put Milan ahead in the fourth minute on the day he failed to overturn a three-match Serie A ban for swearing in the direction of a linesman.

The Swedish striker, who missed Saturday's 3-0 win over Sampdoria that put Milan six points clear in the league, volleyed home from close range at the far post from Massimo Oddo's deep cross.

Argentine forward Javier Pastore leveled 10 minutes later after combining well with Maurizio Pinilla, and young Uruguayan strike partner Abel Hernandez followed up his weekend double from the win over Roma to make it 2-1 in the 53rd minute with a fierce shot that went in off the crossbar.

However, Urby Emanuelson equalized with 14 minutes to play after Ibrahimovic ran into the box and the ball ran loose to the Dutchman.

Pastore could have restored Palermo's lead ahead of the second leg in Sicily on May 10 but goalkeeper Marco Amelia made a fine save to deny him.

Cup holders Inter Milan will take a 1-0 lead into the May 11 home leg of their semi against Roma after Dejan Stankovic scored the only goal at the Stadio Olimpico on Tuesday in a repeat scoreline of last year's final.

@highlight

Real Madrid win Copa del Rey for the 18th time, beating Barcelona 1-0 final

@highlight

Cristiano Ronaldo scores the only goal in Valencia, heading home in extra time

@highlight

Jose Mourinho lifts his first trophy with Real ahead of Champions League semis

@highlight

AC Milan held to a 2-2 draw at home by Palermo in first leg of Italian Cup semifinal