(CNN) -- Roger Federer's preparations for the French Open came to a shuddering halt after he was stunned by Japan's Kei Nishikori at the Madrid Open Thursday.

World No.2 Federer, who was playing his first tournament since losing to Rafael Nadal at Indian Wells in March, suffered a 6-4 1-6 6-2 third round defeat by the 14th seed.

The Swiss ace follows World No.1 Novak Djokovic in crashing out of the tournament with the Serb star losing to Bulgaria's Grigor Dimitrov on Tuesday

Federer, 31, has won 17 grand slam titles during his illustrious career, but has managed just one win at Roland Garros.

This defeat will see him slip down below Andy Murray to number three in the world and Federer admits his performance came as something as a surprise.

"Overall, I'm pretty disappointed with my play," he told a press conference following the match.

"I'm not sure how well Kei thought he played. I didn't think he had to play his very best either, which is even more disappointing.

"It doesn't change my mindset going forward. I'm going to go back to the practice court, train hard, and make sure I don't have these kind of days anymore."

But while the start of the French Open is less than three weeks away, Federer is adamant this latest setback will not affect his chances of glory at Roland Garros.

He told reporters: "We're not playing for the French Open. This is early. We're weeks away from the French Open.

"It's nice to have the French Open as a tournament on the calendar but not everything is sacrificed for that.

"For that particular player or for the media or the fans the French Open is the ultimate thing and the only thing they care about.

"Then clearly Madrid is the lead up tournament.

"That's not how I see it. For me, every tournament counts.

"So I'm as disappointed losing here as the French Open. There is no difference really."

But for Nishikori, who lost his only previous meeting in straight sets against Federer in Basel two years ago, this was possibly the greatest win of his career.

"He's my idol," the 23-year-old told reporters after seeing off Federer.

"Beating him was one of my career objectives.

"It's fantastic that this happened on a clay court. As you know, it's not my best surface."

"I lost second or third round last week and I was struggling a little bit so I didn't have much confidence.

"But I played two good matches in the first and second round and to beat Roger, well, I'll need a couple days to celebrate."

Nishikori will play Spanish qualifier Pablo Andujar for a place in the semifinal.

Meanwhile, Rafael Nadal is into the last eight after defeating Russia Mikhail Youzhny 6-2 6-3.

The World No.5, who lost out in the third round last year, has won four titles since his return to action in February following a seven-month injury layoff.

Nadal, who is hoping to win an eighth French Open crown in Paris, told Spanish television that he was happy with his current level of fitness.

"We are just doing what we can every day," the 26-year-old told La Sexta.

"I am in the quarterfinals and it makes me very happy to have another chance to play in Madrid in front of these magnificent fans.

"It's not the time to be talking more than necessary. I will try to enjoy every moment as much as possible."

Meanwhile, sixth seed Tomas Berdych sealed a quarterfinal place with a 7-6 7-5 win over Kevin Anderson.

Jo-Wilfried Tsonga, seeded seventh, came from a set down to defeat Spain's Fernando Verdasco 4-6 6-3 6-2.

But there was bad news for Djokovic's conqueror, Dimitrov, who was beaten 3-6 6-4 6-1 by Stanislas Wawrinka.

In the women's side of the tournament, World No.1 Serena Williams cruised into the last eight with 6-3 6-1 win over Maria Kirilenko.

Williams, who suffered a shock opening round defeat at last year's French Open, has now won eight straight matches on clay this season.

"I think more than anything I learned not to become overconfident," she told reporters.

"I think I'll just take that with me to the French this year. I think I was a little confident last year and I felt really good; this year I'm going to take every moment like it's my last."

Maria Sharapova booked her place in the quarterfinals with a comfortable 6-2 7-5 win over Germany's Sabine Lisicki.

And Sharapova, currently ranked second in the world, believes she's in great form going into the defense of her title at Roland Garros.

"I think when you win a Grand Slam on a surface, it would be pretty mean of me to say that I'm not comfortable on the surface," she told reporters.

"It took me many years to get to the level of where I am today. It certainly didn't happen overnight.

"I worked extremely hard on getting stronger and recovering better, moving better on the court, giving myself a better position on the court, especially after being on the defensive and trying to play aggressively as I always do on quicker surfaces."

@highlight

Kei Nishikori defeated Roger Federer in quarterfinal of Madrid Open

@highlight

Japanese star will play Rafael Nadal in last four

@highlight

Nadal cruised past Russia's Mikhail Youhzny 6-2 6-3

@highlight

Victories for Serena Williams and Maria Sharapova