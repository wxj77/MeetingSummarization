Dennis Marx wore body armor and a gas mask. He brandished an assault rifle, an assortment of grenades, "all kinds of ammunition" and even used his silver Nissan SUV as a weapon of sorts, according to authorities. The 48-year-old man toted his own water supply and flexible handcuffs, presumably to corral hostages once he got inside the north Georgia courthouse.

As Forsyth County Sheriff Duane Piper said, "He came prepared to do this."

But Dennis Marx never even made it inside.

A nearly three-minute long gunfight Friday ended with Marx dead, after being confronted by a swarm of law enforcement officers.

They seemingly came from everywhere -- from the jail across the street, as part of a SWAT team that happened to be nearby and even inside the courthouse where they busted out windows in order to get more angles to target the attacked.

Piper singled out one officer in particular -- a veteran sheriff's deputy who first confronted Marx, who then tried to run the deputy over -- for his vital part in deterring the attacker. Shot twice in the leg, the deputy was the only person wounded despite what the sheriff called "a full frontal assault."

"It was very close to being a major catastrophe," Piper said. "The deputy that was shot ... averted what, I think, would have been a lot more deaths."

Swift, significant response to attack

Marx was supposed to be at the Forsyth County Courthouse in Cumming. Court documents show he faced 11 felony charges --  10 of them related to the manufacture, possession and sale of illicit drugs, including marijuana, plus one count of having a firearm while in the commission of a felony -- dating back to August 2011.

According to the sheriff's office, he was expected to enter a plea Friday before Chief Superior Court Judge Jeffrey Bagley.

Needless to say, he never made it.

Instead, around 10 a.m. Friday, Marx drove up to the courthouse, threw out "homemade spike strips" to delay any police response, and tried to run over the deputy, Piper said.

The deputy -- a 30-year veteran whose duties include canvassing the scene outside the courthouse -- opened fire, and Marx returned fire through his windshield.

He didn't stop with bullets. According to the sheriff, Marx tossed tear gas grenades, smoke grenades and pepper spray grenades -- something he could do more easily with his gas mask strapped on.

Despite this barrage of weapons, the sheriff's deputy was able to distract Marx, to slow him. Even a little delay made a big difference, as officers armed with assault rifles came over from the jail across the street.

A SWAT team pulled up about 30 seconds into the firefight and engaged the attacker, according to Piper. The sheriff initially estimated the whole thing took 90 seconds but, after watching more video, he doubled that time.

However long it lasted, it ended with Marx dead of multiple gunshot wounds.

With eight officers opening fire at one point, authorities don't yet know which one of them fired the fatal shot.

'He was there to occupy the courthouse'

Afterward, the wounded deputy -- identified by local media as James Daniel Rush -- was transported to a local hospital.

There, the officer had surgery for fractures to his  fibula and tibia in the lower right leg, injuries Piper said weren't life-threatening.

But his colleagues still had to work to do. They went to Marx's home in Cumming, a small city about 35 northeast of downtown Atlanta, with every expectation that it was booby trapped.

As Piper said: "Last time we were at the home, we were suspicious because it had been booby trapped before."

Once they finally made their way in and cleared the house, they found homemade explosives, according to a law enforcement source. It wasn't clear whether those were attempted booby traps.

A preliminary investigation found that Marx hadn't been in his Cumming home for about 10 days. Besides that, little is known about him beyond that he began working at the Transportation Security Administration in October 2002, according to a U.S. official, and left either the next year or in 2004.

The sheriff said Friday that he and others weren't ready yet to discuss Marx's motive or his thinking.

That said, Piper said it was evident that Marx "came prepared to stay a while."

"We don't know who he was coming to the courthouse for, but with the flex ties and the restraining devices he had with him," said the sheriff. "We have to assume that he was there to occupy the courthouse."

Who is the student who pounded on the Seattle gunman?

Canada shooting: Suspect yelled 'I'm done' at time of arrest

Navy seals off Virginia military hospital in hunt for stabbing suspect

@highlight

"It was very close to being a catastrophe," sheriff says

@highlight

A deputy underwent surgery after being shot in the leg

@highlight

Dennis Marx was armed with gas grenades, assault rifle, and spike strips, police say

@highlight

Sheriff: Carrying flexible handcuffs, he appeared intent on taking over courthouse