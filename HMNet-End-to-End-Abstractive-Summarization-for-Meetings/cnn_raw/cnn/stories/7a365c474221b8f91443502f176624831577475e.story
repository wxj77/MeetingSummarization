Sao Paulo, Brazil (CNN) -- Brazil's Senate passed a controversial forestry bill late Tuesday, supported by ranchers and farmers but opposed by many environmental activists.

Supporters say the legislation will help cut carbon emissions and establish more realistic deforestation rules in what has become Brazil's fast-growing agricultural frontier.

After a long debate, senators voted 59 to 7 to approve the legislation.

The new "forest code" now returns to the lower house for approval and then must be signed by the president.

The bill reduces the percentage of land that farmers and ranchers must maintain as forest when they develop it. It also establishes an amnesty for some past illegal deforestation.

Critics say it will encourage developers to continue to illegally cut down the Amazon forest while supporters say it brings the country's legal framework in line with reality.

In recent years, private ranchers and growers as well as the government have invested millions to expand soybean and beef production and build massive hydroelectric dams in the region.

"Brazil has to take care of the environment, but at the same time it also has a responsibility to feed the world," Senator Jorge Viana said in a statement released by a pro-legislation lobby.

Brazil is the world's No. 1 beef exporter and second biggest soy exporter.

On Monday, Brazil announced that deforestation in the Amazon had fallen to a record low for the third straight year, providing more support for the forest code.

Under the approved rules, developers will still be required to preserve some land as forest and replant other areas, thus helping cut carbon emissions.

But stricter limits and fines have been stripped out of it.

Environmentalists say that changes to the decades-old regulations on deforestation were necessary, but that the amnesties granted in this bill are excessive.

Greenpeace Brasil called it a "Day of Shame."

It is expected to land on the desk of President Dilma Rousseff early next year. It could prove a challenge for the new leader, who has supported development initiatives in the region, but who must also placate left-wing environmentalists in her coalition.

@highlight

Supporters say the legislation is realistic

@highlight

Opponents say it will encourage developers to illegally cut down the Amazon forest

@highlight

The code could be a challenge for President Dilma Rousseff