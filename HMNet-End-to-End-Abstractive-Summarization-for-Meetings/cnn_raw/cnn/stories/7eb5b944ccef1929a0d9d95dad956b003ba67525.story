Los Angeles (CNN) -- The good news for Chris Brown is a luxury rehab center in Malibu is better than the men's central jail in Los Angeles.

The bad news is a Los Angeles judge ordered Brown to stay another two months in the anger management and drug rehab program he entered three months ago.

Although Brown's probation officer reported the singer "continues to make great improvement" in dealing with anger, stress and drugs, the judge decided during a hearing Friday he can't go free yet. He has to be tried on an assault charge in Washington first.

Only then will the judge decide whether Brown must go to jail for violating his probation in the Rihanna assault because of the assault arrest a few blocks from the White House in October.

Brown seemed disappointed by the decision, although his three months of therapy may have helped him handle the stress in court. He closed his eyes and appeared to meditate for about five minutes while his lawyer, Mark Geragos, met privately with the judge and prosecutor.

"Mr. Brown is able to use behavioral strategies to manage acting out on impulses," the director of his rehab program wrote in a letter to the court. "Mr. Brown is teaming relaxation exercises that will reduce consequent impulsive behaviors."

He also looks physically better during his latest court appearance, something noted by his lawyer.

The rehab director's letter revealed that Brown had been suffering from a "severe case of insomnia," which has been "stabilized."

Brown, 24, told his probation officer that he "appreciates what he has learned in the rehabilitation facility, as it has allowed him to change his life for the better," the officer wrote in his report.

Brown "looks forward to staying out of trouble," the probation report said.

He reports to a highway cleanup labor crew in Los Angeles three days a week to fulfill the 750 hours of service remaining in his probation requirements, the report said. At that rate, Brown could complete the labor in mid-October and possibly be free from probation requirements by the end of the year.

His legal troubles began five years ago when he beat then-girlfriend Rihanna in a rented Lamborghini on a Hollywood street. He pleaded guilty to felony assault in June 2009, which resulted in a sentence of five years of probation and 1,400 hours of community labor.

The judge has revoked Brown's probation twice in the last year, most recently because of his arrest on a sidewalk near the White House after allegedly punching a man.

Brown voluntarily entered a rehab program a day after being released from a Washington jail in October, but he was kicked out a few days later for "throwing a rock through his mother's car window" after a family session at the center, a probation report said. Brown was upset because his mother said she wanted him to stay in treatment, the report said.

"Mr. Brown preceded to walk outside and pick up a rock and threw it through his mother's car window and it shattered," according to letter from the rehab center included in the probation report.

His mother sat next to Brown at Friday's hearing.

Los Angeles County Judge James Brandlin will revisit Brown's rehab versus jail status on April 23, a week after the assault trial in Washington.

@highlight

Chris Brown must stay in rehab until his Washington assault charge is tried

@highlight

Brown's probation has been revoked twice in the past year

@highlight

The singer appeared to meditate in court

@highlight

The rehab director says Brown is learning new ways to deal with anger, stress