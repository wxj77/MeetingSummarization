Los Angeles (CNN) -- The legal troubles threatening to send Chris Brown to prison for several years began with the singer's arrest five years ago in the brutal attack on then-girlfriend Rihanna.

Brown has spent almost all of the past six months either in rehab or jail. He's been locked up since he was booted from a court-ordered substance abuse and anger management program on March 14.

Brown has two pending criminal cases, both stemming from his alleged inability to control his anger.

Brown's D.C. assault case

Brown, 24, and his bodyguard, Christopher Hollosy, allegedly punched Parker Adams after a quick exchange of words on a sidewalk blocks from the White House last October. Brown was arrested on a felony assault charge, but it was reduced to a misdemeanor and he was released on bond the next day. The trial is set to begin Wednesday in D.C. Superior Court.

The judge who presided over the separate trial of Brown's bodyguard was taken off of Brown's case Monday. D.C. Superior Judge Patricia Wynn said as she announced her guilty verdict for Hollosy that she believed the testimony of a limousine driver who said he saw Brown hit Adams and that Adams did not fight back.

Replacing Wynn with Judge A. Franklin Burgess, a retired judge, gives Brown a fresh start with a judge who has not already given an opinion on the evidence against him.

Brown's defense has been complicated by Hollosy's conviction, because the bodyguard's testimony could hurt his own appeal. Prosecutors are considering whether they will grant immunity to Hollosy for anything he says in Brown's trial. Brown's lawyer, Mark Geragos, says the bodyguard's testimony is crucial to Brown's defense.

Hollosy did not take the stand in his own trial, but his lawyer indicated Hollosy would say that he hit Adams because Adams was trying to get on Brown's bus, and it was his job to protect his client.

California probation revoked

A conviction in the Washington case would be trouble for Brown because of his probation for the felony assault conviction in Los Angeles. The judge overseeing that case has already ruled that the singer violated his probation by being arrested last October, but he is waiting until after the D.C. trial to decide whether the revocation will become final. The revocation decision will be made at a hearing after Brown returns to Los Angeles from Washington.

Planes, chains and automobiles: Chris Brown's miserable trip to trial

If convicted in Washington, Brown faces another grueling "Con Air" trip. The U.S. Marshal's Service is committed to returning him to the Los Angeles jail through the U.S. Justice Department's notoriously slow and uncomfortable prisoner transport system.

If Brown is acquitted in the Washington case, his lawyer will argue that he should be immediately released from jail and allowed to resume his probation. Even then, Brown must work at least three days a week on a road clean-up crew to complete more than 700 hours of community labor remaining on his sentence in the Rihanna assault.

@highlight

NEW: Brown gets a new judge after bodyguard is found guilty

@highlight

Brown's criminal cases stem from his alleged inability to control anger

@highlight

A Los Angeles probation hearing depends on the outcome of his D.C. trial

@highlight

Even if acquitted in D.C., Brown has 700 hours of community service remaining