(CNN)  -- Five-time U.S. Open winner Roger Federer battled past Marin Cilic of Croatia to reach the last 16 of a grand slam for the 30th straight time Saturday.

27th seed Cilic took the second set but the Swiss maestro then took command and ran out a 6-3 4-6 6-4 6-2 winner at Flushing Meadows.

Cilic, who had thrashed Bernard Tomic in the second round, looked set to cause an upset until 4-4 in the pivotal third set.

Facing a break point, he was warned for taking too much time between points and promptly served a double fault.

Federer duly served out for the set and waltzed through the fourth.

"Coming in I knew it was going to be tricky and I'm happy that I was able to counter his pace and his good play," he told gathered reporters after his win.

"It was a tricky match, especially at one set all. At the beginning of the third set I thought that was a key moment because he had momentum on his side."

In later play, in-form Mardy Fish maintained his impressive run with a straight sets win over dangerous outsider Kevin Anderson of South Africa, 6-4 7-6 (7-4) 7-6 (7-3).

Fish is the highest ranked American left in their home grand slam in New York.

But Czech ninth seed Tomas Berdych and Marcel Granollers, the 31st seed from Spain both had to quit their third round matches through injury.

It takes to 10 the number of players who have withdrawn through injury in the men's singles, with four going in the women's.

In Saturday's night session, world number one Novak Djokovic -- who has lost just twice in 2011 -- defeated Russian Nikolay Davydenko 6-3 6-4 6-2 to set up a last 16 clash with Ukraine's Alexandr Dolgopolov.

The Australian Open and Wimbledon champion had only dropped three games in his first two matches, but he was given a sterner test against Davydenko, a semifinalist here in 2006 and 2007.

Djokovic told reporters: "I played well at important moments and got the crucial breaks in all three sets.

"He was aggressive and stayed close to the lines, but I was too passive and I wasn't happy with the game."

@highlight

Roger Federer beats Marin Cilic in four sets in U.S. Open third round

@highlight

Federer survives scare as Croatian takes second set at Flushing Meadows

@highlight

Top seed Novak Djokovic also reaches fourth round after beating Nikolay Davydenko

@highlight

Ninth seed Tomas Berdych forced to quit with a shoulder injury in New York