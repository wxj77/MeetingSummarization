(CNN) -- The Marine Corps has dropped charges against the commander of the Marine company involved in the 2005 killings of Iraqi civilians in Haditha, Iraq.

Camp Pendleton's commanding officer ordered charges dropped against Capt. Lucas McConnell.

Capt. Lucas McConnell, who had been charged with dereliction of duty, was also granted immunity to ensure he cooperates with the investigation, the service said Tuesday.

McConnell was one of four officers charged with failing to properly investigate and report the civilian deaths.

Lt. Gen. James Mattis, the Marine commander in charge of the corps' units in the Middle East, ordered the charges dismissed last week.

"Lt. Gen. Mattis determined that administrative measures are the appropriate response for any errors or omissions allegedly committed by McConnell," according to a statement from the Marine Corps base at Camp Pendleton in California.

Four Marines from McConnell's unit were charged with murder in connection with the deaths of up to two dozen civilians in Haditha in November 2005. Charges have been dropped against two of them -- one in exchange for his testimony and the other after a hearing officer decided he acted in accord with the rules of engagement.

Two other officers -- Lt. Col. Jeffrey Chessani, the battalion commander, and 1st Lt. Andrew Grayson -- also face charges related to their response to the killings.

Haditha, located along the Euphrates River northwest of Baghdad, was the target of several Marine campaigns aimed at rooting out insurgents from 2004 through 2006.

Prosecutors accused the Marines of going on a rampage after a roadside bomb killed one of their comrades, 20-year-old Lance Cpl. Miguel Terrazas, on November 19, 2005.

A statement from the Marine Corps originally blamed the deaths on the roadside bomb, triggering a parallel investigation into how commanders handled the incident. E-mail to a friend

@highlight

Capt. Lucas McConnell was accused of poor investigating, reporting of deaths

@highlight

Two other officers face charges related to their response to the killings

@highlight

Incident killed up to two dozen civilians in Haditha, Iraq, in November 2005