(CNN) -- The fighting among Shiite militias and government troops in Basra is a glimpse of Iraq's future, and pivotal cleric Muqtada al-Sadr is in deep trouble, according to two CNN correspondents and a CNN military analyst.

Mehdi Army fighters wear masks during clashes in the southern Iraqi city of Basra on Wednesday.

The fiery religious leader has a loyal following in Baghdad's Sadr City neighborhood and other enclaves thanks to generous social programs, but his political movement, his Mehdi Army militia and the cease-fire al-Sadr recently extended are no match for Iranian intrigue, according to CNN's experts.

"Al-Sadr is involved in a very complicated relationship with the Iranians," said CNN Baghdad correspondent Michael Ware. "The Iranians do provide funding and support for his militia, yet at the same time they're trying to rein him in and get him to adopt a certain political agenda, which from time to time he resists."

Ware said Iran wants to use al-Sadr's populist base to advance its agenda in Iraq. "However, they don't want to see him get too big for his boots or to rise to a position where they can no longer have sway over him."

Iran has weakened al-Sadr by encouraging dissension within his Mehdi Army and backing hardliners -- known as the Special Groups -- who break away and keep up the fight against the U.S. occupation, Ware said.

"Iran's very good at putting pressure on you, forcing you to split, and anything that squeezes out the side, Iran picks up and turns into hardline factions," Ware said. "That's exactly what's happened to Muqtada. He's had purge after purge after purge of belligerent commanders, and they've all been swept up by Iran.

"And now the most lethal attacks on U.S. forces, the most coordinated attacks on U.S. forces, the most daring attacks on U.S. forces in the country are committed by Iranian-backed breakaway elements of Muqtada's militia faction."  Learn more about the Mehdi Army and other key players in Basra »

The violence in Basra -- which has spread to Shiite areas throughout the country, including Baghdad -- is a kind of fighting Americans are unaccustomed to seeing, said retired Air Force Maj. Gen. Donald Sheppard, CNN's senior military analyst.  Watch the violence multiply »

"This is intra-Shia. This is not Sunni vs. Shia, this is not civil war, this is not sectarian violence, it's intra-Shia politics for control of the government," he said.

Prime Minister Nuri al-Maliki is trying to hold together his political alliance -- an alliance that includes the political wings of the militias he's fighting, Sheppard said.

"If this alliance breaks apart because of the fighting, you've got chaos within the Parliament," Sheppard said.  Watch Sheppard assess the military situation »

So far, al-Sadr has resisted the temptation to end the Mehdi Army cease-fire, which, combined with the simultaneous increase in U.S. forces last year, had brought a sharp reduction in violence.

If the truce ends, "the success of the surge is going to be hugely in doubt," said CNN International correspondent Michael Holmes. "I've always said, yes the surge has reduced violence in Baghdad, but you have to put it in context: Why has it reduced the violence, and what else has happened?

"It's a lot like squeezing a balloon, as a general told me: You squeeze it in Baghdad, it pops out elsewhere. Where you've seen a lot of the militiamen go, a lot of the insurgents go, is to the south and mainly to the north, which is why you're seeing a lot of action up in Mosul."

And the Mehdi Army and Badr Brigades -- the principal combatants in the Basra region -- are hardly the only militias at arms in Iraq. Indeed there are dozens, each with its own political, social, religious and military agenda, Ware noted.  Watch Ware look ahead to a post-American Iraq »

"What worries me the most is all of the good work that we've done with the surge, spreading higher levels of security throughout Iraq, the people slowly gaining confidence in their own security forces -- that could all break down," Sheppard said.

"It could all break down because of Basra, it could break down because al-Sadr basically ends the truce and fighting starts all over the country in the Shia areas.

"This is very, very serious and it could all go wrong for the United States as we try to extricate ourselves. It could go wrong in many, many ways and cause everything to come apart there."

But Holmes suggested there's a chance al-Maliki and Iraq will survive this crisis.

"This could be a good test of Nuri al-Maliki and the security forces. They're going to have to stand up at some point; maybe this is a time to see how they do."

Ware doubts the security forces can prevent a meltdown.

"This is a window into the future of Iraq after the American withdrawal," Ware said.

"What many people suggest is that we're looking at a situation that will be akin to Lebanon in the 1980s, with vicious, well-armed militia proxy wars where all the factions are supported by one foreign sponsor or another.

"But this will be Lebanon on steroids." E-mail to a friend

@highlight

CNN analysts assess what Basra fighting says about Iraq's future

@highlight

Michael Ware: Iran fosters clashes among rival Shiite factions

@highlight

Michael Holmes: Crisis is opportunity for central government to stand up

@highlight

Sheppard: Breakdown could lead to political chaos, loss of gains from surge