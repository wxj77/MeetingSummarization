(CNN) -- Majid Shoukat Khan, a terror suspect who has been held at Guantanamo Bay, Cuba, pleaded guilty Wednesday to all charges as part of a deal that requires him to testify against other detainees.

Khan, 32, is expected to spend up to 19 years behind bars in exchange for the agreement, according to Army Col. James Pohl, the presiding military commission judge.

"If I keep my side of the bargain, they'll keep their side of the bargain," Khan said during the proceeding Wednesday. He was charged with conspiracy, murder and attempted murder in violation of the law of war, providing material support for terrorism and spying.

Pohl pronounced Khan guilty Wednesday and said the sentencing is expected to take place in four years. The defendant will be required to provide testimony against his fellow detainees during those years leading up to the sentencing. He'll then receive credit for time served, leaving up to 15 years on his sentence, Pohl said.

In the deal, Khan -- who had faced the prospect of life in prison -- has agreed to be interviewed by government investigators without his own legal counsel present, provided that the government gives his attorney reasonable notice.

He also agreed not to disclose information about his capture or the conditions surrounding how he and other detainees were treated.

Khan, who attended high school in Baltimore, was held for more than three years at secret CIA prisons and "subjected to an aggressive CIA detention and interrogation program notable for its elaborate planning and ruthless application of torture," his lawyers have said, according to court documents.

Details of Khan's torture claims were redacted in the filing, but Khan's attorneys have said he suffers "severe physical and psychological trauma from which he is unlikely ever to recover fully" as a result of his ordeal.

Asked earlier about Khan's claims, then CIA spokesman Paul Gimigliano told CNN, "CIA's terrorist interrogation effort has always been small, carefully run, lawful and highly productive. Fewer than 100 hardened terrorists have gone through the program since it began in 2002, and of those, less than a third required any special methods of questioning. The United States does not conduct or condone torture."

As part of the agreement reached Wednesday, Khan is also no longer recommended to be housed at the island's facility's Camp 7, where high-value detainees have been kept.

"Majid was tortured prior to his arrival at Guantanamo Bay, but he made a decision despite that, and despite everything that's transpired in his life, he made a decision to accept responsibility for his actions and to really try to achieve some measure of redemption in his life," said J. Wells Dixon, one of Khan's civilian attorneys. "The United States government should accept responsibility for what happened to him, just the way that he accepted responsibility today for his actions and the actions of his co-conspirators."

Another civilian defense attorney for Khan said her client has "taken a leap of faith."

"And he's taken a leap of faith that this process will work the way that we're all intending it to work," said Katya Jestin.

But the overall agreement has prompted controversy over Khan's treatment and what information can be gleaned after years behind bars.

"Any plea deal and testimony by Majid Khan must be seen in the context of his years of secret, incommunicado detention and torture at the hands of the CIA, and the prospect of trial by an unfair military commissions system," said Zachary Katznelson, a senior lawyer for the American Civil Liberties Union who was at Guantanamo to observe the proceedings.

The U.S. military said Khan traveled from Baltimore to Karachi, Pakistan, in 2002 to help al Qaeda plan attacks in the United States and elsewhere. The military said Khan conspired with Khalid Sheikh Mohammed, the accused mastermind of the September 11 terrorist attacks, to blow up underground storage tanks in the United States.

The government said Khan had also recorded a "martyr video" and donned an explosive vest and waited in a mosque where then-Pakistani President Pervez Musharraf was expected. The plan failed when Musharraf did not show up.

He also was accused of giving $50,000 in al Qaeda funds to a Southeast Asia-based al Qaeda affiliate, which then gave the money to Jemaah Islamiyah to fund the August 2003 bombing of the J.W. Marriott Hotel in Jakarta, Indonesia.

That incident killed 11 people and wounded at least 181 others.

CNN's Carol Cratty contributed to this report.

@highlight

"If I keep my side of the bargain, they'll keep their side of the bargain," said Majid Shoukat Khan

@highlight

The plea is part of a deal that would require him to testify against other detainees

@highlight

He was charged with conspiracy, murder and attempted murder in violation of the law of war

@highlight

Majid Shoukat Khan pleaded guilty Wednesday to all charges