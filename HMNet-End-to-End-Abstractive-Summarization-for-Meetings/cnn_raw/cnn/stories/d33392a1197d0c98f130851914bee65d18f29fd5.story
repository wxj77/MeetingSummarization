Washington (CNN) -- Pharmaceutical giant Merck will plead guilty to charges related to illegal promotional activity for the painkiller Vioxx and pay fines and settlement costs totaling nearly a billion dollars, the Justice Department announced Tuesday.

Justice officials said Merck, Sharp and Dohme Corp. has agreed to the massive settlement to resolve criminal charges and civil claims stemming from its promotion and marketing of Vioxx. The drug was withdrawn from the marketplace in September 2004.

Under the agreement, Merck will plead to a misdemeanor charge for the illegal promotion and pay a $321 million criminal fine.

The firm also agreed to a civil settlement under which it will pay $628 million to resolve allegations of off-label marketing and false statements about the cardiovascular safety of Vioxx.

The federal government will receive $426 million from the civil settlement and the remaining $202 million will be distributed to the participating Medicaid states, the Justice Department said.

"When a pharmaceutical company ignores FDA rules aimed at keeping our medicines safe and effective, that company undermines the ability of health care providers to make the best medical decisions on behalf of their patients," Assistant Attorney General Tony West said.

The FDA approved Vioxx for three medical purposes in 1999 but did not approve its use against rheumatoid arthritis until April 2002. The government says that for nearly three years in the interim, Merck promoted Vioxx for rheumatoid arthritis. An FDA warning letter was sent to Merck in 2001 for making the claims.

Officials say that while this is not a record settlement, the $950 million agreement places it among the top five on record.

@highlight

The fines stem from both a criminal and a civil case

@highlight

The company promoted Vioxx for rheumatoid arthritis before it had approval

@highlight

Vioxx was not approved for that use until April 2002