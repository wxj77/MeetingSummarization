(CNN) -- Microsoft's revenue has been growing -- slowly, but growing.

Profits have been growing faster than revenue, as the company clamps down on expenses. The company's core business software like Office 2010 has been showing great results for more than a year now, and the Xbox had its best holiday season ever, as Microsoft sold a million in a single day after Thanksgiving. Plus, it's got more than $50 billion in cash.

So why has the company's stock stubbornly refused to move for the last decade?

Why do big investors keep calling for CEO Steve Ballmer's head?

The problem comes down to a simple statistic that should scare the heck out of Microsoft and its investors:

Five years ago, 95% of devices connected to the Internet were Windows PCs.

Right now, less than 80% are, and some folks expect the number to drop below 20% in a few years.

That's a historic shift, and is just one of many signals that the personal computer is no longer dominant in the ever-shifting world of consumer technology.

Credit the explosion in smartphones, led by Apple's iPhone and a bunch of other phones running Google's Android (which is more popular than the iPhone by sheer numbers).

Apple's iPad has also made a big dent, taking up the equivalent to about 10% of the PC market -- and it's less than 2 years old.

Microsoft is nowhere in the worlds of smartphones or tablets.

But this year, the company hopes to change all that.

Next month, the company will let the masses download and test a not-quite-finished version of Windows 8, which Ballmer has called the most important product in company history.

Windows 8 is going to be a little bit all over the place. On the surface, it will have a cool, modern look and feel that's meant to be used with touchscreen tablets. Call it an iPad killer if you will. It's cutting edge and friendly, filled with bright, colorful squares and sliding screens, and it's going to have a lot of features that will be familiar to iPhone and iPad users, like an app store.

If you buy a Windows tablet, that's probably what you're going to see and use most of the time.

But Windows 8 will also run on regular old PCs, and underneath the new tablet-friendly interface, it will look and feel a lot like the old version of Windows. If you're using a desktop PC or laptop PC at work, you'll probably end up using the old interface.

It's a tricky balancing act to pull off, and lots could go wrong -- for instance, it's not exactly clear how smooth it will be to switch between the two types of Windows, or if you'll even be able to get the old Windows on certain types of tablets (that is, tablets that run the power-efficient ARM processors used by the iPad and most other tablets today).

But if past Windows launches are any guide, Microsoft will help its cause by spending hundreds of millions of dollars on high-profile TV ads, viral whisper campaigns and "co-marketing" money for its PC hardware partners and the resellers who push Microsoft software to big corporations.

But Windows 8 is only half the equation.

Microsoft came out with a surprisingly good smartphone platform way back in fall 2010 -- in some ways, it was better than the iPhone from the moment it launched.

But for a variety of reasons -- including mediocre phones that run the operating system, lack of support from big carriers like Verizon and some big gaps with features and apps -- it flopped.

A year later, Microsoft 's Windows Phone platform is still at less than 2% market share, way behind Apple, Android and even the struggling BlackBerry.

But this year, Microsoft has teamed up with Nokia, the biggest cell phone maker in the world, to push a new line of Windows Phones. Its flagship phone, the Lumia 900, has received universally great reviews -- almost like the kinds of reviews the iPhone got when it came out.

Equally important, Microsoft has committed hundreds of millions of dollars to marketing these new phones, including paying commissions to staffers at retail stores. That's critically important, as a lot of retail store clerks didn't even know what a Windows Phone was last year.

Windows 8. Windows Phone. Expect Microsoft to push those products like its future depends on them. Because it does.

Copyright Â© 2011 Business Insider.

@highlight

Microsoft is nowhere in smartphones or tablets, but the company hopes to change that

@highlight

Next month, users will be able to download and test a not-quite-finished version of Windows 8

@highlight

Microsoft has teamed up with Nokia, the biggest cell phone maker in the world