WASHINGTON (CNN)  -- A man who his attorney says was the youngest prisoner sent to the Guantanamo Bay detention center -- captured in Pakistan at 14 -- was ordered freed by a federal judge Wednesday.

A guard keeps watch from a tower at the military facility at Guantanamo Bay, Cuba.

The judge ruled Mohammad el-Gharani was not an enemy combatant and directed the military "to take all necessary and appropriate diplomatic steps to facilitate the release" of el-Gharani from the U.S. base at Guantanamo Bay, Cuba.

El-Gharani, now 21, was among the first terrorism suspects and enemy fighters sent to the U.S. military prison camp. His arrival in 2002 came after he was seized by Pakistanis at a mosque and transferred to the U.S.-led coalition. He has been in custody since.

El-Gharani's lawyers filed a habeas corpus petition in federal court, demanding the government justify its continued detention or release him.

Details of his case have not been widely released, but his lawyer said he was accused of working with al Qaeda 10 years ago, at age 11. The court ruling also alleges el-Gharani, a citizen of Chad, was an al Qaeda courier and participated in the battle of Tora Bora in late 2001 in Afghanistan.

But U.S. District Judge Richard Leon noted serious questions were raised about another detainee who implicated el-Gharani.

Leon said that given the "substantial and troubling uncertainties regarding petitioner's conduct and whereabouts prior to his detention by Pakistani forces, the [U.S.] government has failed to establish a preponderance of the evidence" that el-Gharani was an al Qaeda agent.

The judge gave no timetable on when the suspect -- also called Yousef -- must be freed. Under U.S. and international policy, he could not be sent to a country where he might face torture or severe physical mistreatment. The Bush administration has said it has had difficulties finding countries willing to take many Guantanamo prisoners awaiting release.

El-Gharani's lawyers have alleged mistreatment by his captors, including cigarette burns and verbal abuse.

Court records allege he was a native of Saudi Arabia who left that country around 2001 and moved to Pakistan. He denied that he was fleeing the fighting in Afghanistan when he was captured across the border in Pakistan.

Another Guantanamo detainee, Canadian Omar Khadr, was 14 or 15 when he was captured six years ago. Military prosecutors formally charged him in April 2007 with killing Sgt. Christopher James Speer, a U.S. soldier whose reconnaissance patrol was ambushed in Afghanistan in 2002. The American died nearly two weeks later. Khadr and el-Gharani remain among the youngest of Guantanamo's approximately 250 prisoners.

The civil case is el-Gharani v. Bush (05-429).

@highlight

Mohammad el-Gharani, now 21, not an enemy combatant, U.S. judge rules

@highlight

El-Gharani was 14 when he was captured in Pakistan, detained at U.S. base in Cuba

@highlight

Judge notes questions raised about a detainee who implicated el-Gharani

@highlight

El-Gharani was accused of being al Qaeda courier, Tora Bora battle participant