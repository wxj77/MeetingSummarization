Joint Base Lewis-McChord, Washington (CNN) -- For three weeks, security fears kept U.S. authorities from searching the Afghan village where an American soldier is accused of killing 16 Afghans, an Army investigator testified Wednesday.

Local tempers were so high over the killings that it was too dangerous for the Americans to go, said Matthew Hoffman, a special agent with the Army Criminal Investigation Command. Negotiations with local leaders over the issue took 20 days -- and even then, the investigators were guarded by U.S. and Afghan troops and watched over by two U.S. helicopters, he said.

"We were fully expecting to be attacked at any time," Hoffman said. "We didn't know how much time we had for our investigation."

Hoffman's testimony came during an Article 32 hearing for Staff Sgt. Robert Bales, the soldier charged in the killings. The hearing at Joint Base Lewis-McChord, near Tacoma, Washington, will determine whether Bales will face trial for the deaths.

Hoffman was the lead investigator in the case. His team collected blood samples, took photographs and found a number of 9mm shells at the site, but much of the evidence had been collected by Afghan troops the day after the March 11 killings, he said.

The shooting spree near a small U.S. outpost in Afghanistan's Kandahar province last March strained already tense U.S.-Afghan relations and intensified a debate about whether to pull out American troops ahead of their planned 2014 withdrawal.

Stunned friends recall good deeds of killing suspect

Bales is charged with 16 counts of premeditated murder, six counts of attempted murder, seven counts of assault and the illicit use of alcohol and steroids. He could be sentenced to death if convicted.

Another investigator, Trayce Lang, testified Wednesday that she found steroids hidden outside Bales' quarters. The sergeant's lawyer, John Henry Browne, has said that steroid use will be a key factor in Bales' defense.

Bales served three tours of duty in Iraq before being sent to Afghanistan and may have been suffering post-traumatic stress disorder, Browne said. Bales suffered a traumatic brain injury during a roadside bomb explosion and lost part of his foot in separate tours in Iraq, he said.

Afghan villagers describe slaying's horror

The Army has said Bales is the sole suspect in the killings, but Afghan villagers in the area have consistently rejected the contention that Bales acted alone.

Earlier this week, a fellow soldier testified that he and another soldier had been drinking with Bales hours before the attack. An officer, Capt. Daniel Fields, said that when he asked Bales after he surrendered what had happened, Bales replied, "I'm sorry I let you down."

Wartime stress as a defense for murder

@highlight

Army Sgt. Robert Bales is accused of killing 16 Afghan villagers

@highlight

It took nearly three weeks for U.S. agents to visit the site, an Army investigator says

@highlight

"We were fully expecting to be attacked at any time," he says

@highlight

Another investigator testified that steroids were found outside Bales' quarters