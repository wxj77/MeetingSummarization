(CNN) -- Bayern Munich produced a spirited fight back to knock 10-man Manchester United out of Europe's Champions League and set up a semifinal against Lyon.

Trailing 2-1 from the first leg, United raced into a 3-0 lead, but goals from Ivica Olic and Arjen Robben saw Bayern progress on the away goals rule as the tie finished 4-4 on aggregate.

English Premier League champions United were in control until the sending-off of Rafael Da Silva early in the second half handed Bayern the initiative and Robben's stunning volley was worthy of winning any match.

United manager Alex Ferguson sprung a surprise before kick-off by naming Wayne Rooney in his starting line-up just eight days after the England striker twisted his ankle during the first leg.

Rooney landed awkwardly on the same ankle after 20 minutes and seemed to struggle for mobility before he was replaced after 55 minutes.

It was one of Ferguson's other surprise inclusions who opened the scoring. Darron Gibson, selected ahead of Ryan Giggs and Paul Scholes, picked up Rooney's pass and fired a shot past the unsighted Bayern goalkeeper Hans-Jorg Butt.

Four minutes later, United were 2-0 ahead as Antonio Valencia crossed for Nani to score with a sublime backheel.

The German Bundesliga leaders almost leveled the aggregate score when Olic's shot was smothered by United goalkeeper Edwin Van der Sar.

Moments later, United went 3-0 up as Valencia's low cross was smashed into the roof of the net by Nani.

Bayern were given a lifeline before half-time when Croatian striker Olic shrugged off Michael Carrick and fired past Van der Sar from a narrow angle.

United were reduced to 10 men early in the second half when Rafael received a second yellow card for a foul on Franck Ribery.

Nani and Darren Fletcher both went close for United before Van der Sar produced a fine reflex save to keep out Ribery's effort.

United seemed content to soak up Bayern pressure but their resistance was broken by a moment of individual brilliance from Robben.

Ribery's corner picked out the former Chelsea winger on the edge of the area and his volley arrowed past Van Der Sar and into the bottom corner.

Ferguson threw on Dimitar Berbatov and Ryan Giggs in pursuit of a winner but Bayern kept possession with ease to see out a victory that went some way to avenging their defeat to United in the 1999 final.

The defeat capped a miserable few days for United, who lost 2-1 to Chelsea on Saturday to fall two points behind the Londoners in the race for the Premier League title.

"The key thing was losing a goal just before half time and the young boy getting sent off," Ferguson told ITV1.

"It took an exceptional goal to win the tie - it was a fine strike by Robben."

Lyon went into their all-French quarterfinal with Bordeaux carrying a 3-1 lead from the first leg.

But striker Marouane Chamakh gave Laurent Blanc's side hope when he bundled home on the stroke of half-time.

Bordeaux pressed for a goal that would have taken them through, and Lyon were grateful to goalkeeper Hugo Lloris, who produced a one-handed save to keep out Wendel's header.

The home side held on for a 1-0 defeat that saw them progress 3-2 on aggregate.

@highlight

Bayern Munich knock Manchester United out of the Champions League.

@highlight

The Germans fight back from 3-0 down to lose 3-2 but progress on away goals rule.

@highlight

Lyon lose 1-0 to Bordeaux but advance 3-2 on aggregate.