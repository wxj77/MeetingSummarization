(CNN) -- New Inter Milan coach Claudio Ranieri suffered his first defeat on Saturday as Joel Obi was sent off in an ill-tempered 3-0 home reverse against new Serie A leaders Napoli.

Inter were already annoyed to have a 24th-minute goal by Giampaolo Pazzini ruled out for offside, but tempers flared when Nigeria international midfielder Obi was sent to the dressing room for his second yellow card four minutes before halftime.

Television replays showed that Obi pushed Christian Maggio outside the box, but a penalty was awarded by Gianluca Rocchi.

Marek Hamsik's spot-kick was saved by Julio Cesar but Hugo Campagnaro followed up to deftly score from the rebound, and the goal was allowed to stand despite the defender clearly being inside the area when the penalty was taken.

Cesar was booked for shouting at the match official, and the Brazilian was lucky not to be sent off as he continued to harass him.

An angry Ranieri watched the second half from the stands, and saw Napoli take control as Maggio capitalized on poor defending by Japanese defender Yuto Nagatomo to beat a stranded Cesar in the 56th minute.

Inter survived an incredible close-range miss from Juan Zuniga, but Hamsik settled the match with 15 minutes to play as he beat the offside trap to collect a pass from Ezequiel Lavezzi and beat Cesar.

"He wasn't equal in his decisions, it was an unfair game," Ranieri told reporters in quotes carried by AFP. "The first half was a great game but Obi was given a first yellow card when he clearly won the ball.

"Then (the foul) was outside the area and he was given a second yellow card and he was off. That ruined the game.

"It's a shame because we tried very hard, but (the referee) messed up everything there was to mess up."

The result put Napoli on 10 points -- two clear of Juventus, Udinese and Roma -- after completing an early-season double over the two Milan clubs.

Juve host defending champions AC Milan in the pick of Sunday's matches, while Udinese are at home to second-bottom Bologna.

Inter, who had won the first two matches of Ranieri's reign, remained on four points after five matches -- just above the relegation zone.

Roma earlier ended Atalanta's unbeaten start to the season with a 3-1 home victory.

Pre-season signings Bojan Krkic and Pablo Osvaldo gave the capital club a 2-0 halftime lead before Argentine striker German Denis reduced the deficit soon after the interval.

Brazilian midfielder Simplicio netted with nine minutes to go, giving Luis Enrique's side a second successive win and leaving Atalanta on four points along with Inter and promoted Novara.

In Spain, Malaga went top of La Liga with a last-gasp 3-2 victory at home to Getafe as Brazilian forward Julio Baptista scored a spectacular overhead kick two minutes into injury-time.

Getafe had Algerian midfielder Medhi Lacen sent off for a second booking soon after Miku made it 2-1, but Malaga equalized with two minutes to play through Italian midfielder Enzo Maresca.

Big-spending Malaga lead on goal difference from Valencia, who earlier moved up to 13 points with a 1-0 win at home to lowly Granada thanks to an early long-range left-foot strike from Sergio Canales.

Previous leaders Real Betis host Levante on Sunday, when fourth-placed champions Barcelona travel to Sporting Gijon and last season's runners-up Real Madrid visit Espanyol.

In Saturday's other matches, Mallorca came from behind to draw 2-2 at Osasuna as Israeli striker Tomer Hemed netted twice from the penalty spot.

Villarreal needed a late leveler from Paraguay midfielder Hernan Perez to earn a 2-2 draw at home to Real Zaragoza, while Rayo Vallecano drew 1-1 at Racing Santander.

@highlight

Inter Milan beaten 3-0 at home by Napoli as Joel Obi is sent off in first half

@highlight

Visitors top Italian league table ahead of Juventus-AC Milan clash on Sunday

@highlight

Coach Claudio Ranieri suffers his first defeat in charge of Inter

@highlight

Malaga went top in Spain with a last-gasp 3-2 victory at home to Getafe