(CNN) -- Spaniard Pablo Martin claimed his first European Tour win as a professional as he held off home hope Charl Schwartzel by a stroke to win the Alfred Dunhill Championship at Leopard Creek.

Martin claimed the Portugal Open as an amateur, but has since endured a sorry run of form and only narrowly kept his tour card at the end of last season.

But victory in the first tournament of the 2010 Race to Dubai has seen the 23-year-old create history as the first man to win European Tour events as both an amateur and professional.

While Martin triumphed, South African favorite Ernie Els, who had been his closest challenger overnight, slumped to a sorry five-over 77, with a double  bogey on the famous 18th on the course which adjoins the Kruger National Park.

Els, who will skip next week's South African Open, will see his run of winning a tournament every year since 1990 come to an end.

Compatriot Schwartzel provided the main challenge to Martin and came close to forcing a playoff on the 18th.

Two shots behind on the final tee, he pitched close with his third and holed for a birdie, forcing Martin to two-putt from long range to claim the title.

After closing with as three-under-par 69 for a 17-under total of 271, Martin was overjoyed.

"It's an unbelievable feeling," he told www.europeantour.com.

"I am so happy and there was so much emotion today."

The 541-yard 18th - one of the toughest finishing holes in golf - claimed other victims than Els.

Welshman Sion Bebb, only one behind after an eagle on the 13th, crashed to a sextuple bogey 11 after a poor tee shot and then two balls into the water.

Ireland's Gareth Maybin also took seven when lying third and Frenchman Michael Lorenzo-Vera had an eight to fall from fourth to eighth.

But Martin kept his nerve to set a unique record, which New Zealander Danny Lee and Irishman Shane Lowry can match after their wins as amateurs on the European Tour last season before turning pro.

Home golfer Robert Allenby carded a five-under 66 to win the Australian PGA title by four shots at Coolum.

He finished four shots ahead of his nearest challengers, fellow Australians Scott Strange and John Senden, to claim his fourth Australian PGA title.

@highlight

Pablo Martin wins Alfred Dunhill Championship with final round 69 at Leopard Creek

@highlight

Spaniard holds off South African Charl Schwartzel by a shot to claim first pro triumph

@highlight

Martin becomes first man to win European Tour events as an amateur and professional

@highlight

Home favorite Ernie Els slumps to final round five-over-par 77