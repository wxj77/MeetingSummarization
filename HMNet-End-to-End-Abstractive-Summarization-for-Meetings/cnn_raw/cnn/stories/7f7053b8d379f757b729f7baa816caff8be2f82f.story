HILLSBOROUGH, North Carolina (CNN) -- A man who was obsessed with the Columbine High School massacre was found guilty of murder Friday and sentenced to life without parole for gunning down his father before opening fire at a North Carolina high school three years ago.

Alvaro Castillo was fixated with the Columbine High School shootings, mass murders and natural disasters.

Alvaro Castillo, 21, has been medicated during the trial and showed little reaction as the first verdict was read -- guilty of the first-degree murder of his father.

He also was convicted of multiple assault and weapons offenses in the school shooting. No one was killed at the school, but two students were wounded.

The jury deliberated seven hours before rejecting Castillo's insanity defense.

At his sentencing, Castillo thanked "the Lord our God for all his blessings" and thanked his family for being in court.

"I thank my father in heaven for watching down on me" he said.

Later, Castillo apologized to the victims, adding, "I know by my actions I shocked and hurt a lot of people. It wasn't my intention. I simply wanted to help. Now I know I was wrong."

Before pronouncing a sentence of life without parole, Judge Allen Baddour said: "It's frustrating to hear how help -- I think it was available, but everything didn't fit together to get you the help that you needed."

Castillo, who has a history of mental illness, admitted shooting his father and firing at the students, but defense attorneys James Williams and Phoebe Dee argued he was not criminally responsible for his actions because he was legally insane.

Experts for the defense testified that Castillo believed God wanted him to sacrifice his father and the students.

"The only thing that could make this tragedy worse would be if he were convicted of first-degree murder, despite substantial evidence that he was indeed insane at the time that these acts were committed," Williams said during his closing argument.

Prosecutor James Woodall said while Castillo might be disturbed, he does not meet the criteria for a verdict of not guilty by reason of insanity. He said Castillo planned a murderous rampage.

"He wants to be famous and he wants to be somebody. And the only way he can figure out to do that is to kill some folks," Woodall said.  Watch more of the closing arguments »

The 13 days of testimony told the story of an alienated young man who grew up in a dysfunctional family and finally lashed out violently on August 30, 2006.

Castillo, then 18, shot his father, Rafael, 65, seven times in the head and neck as he sat on the couch reading, according to testimony. Castillo covered his father's body with a sheet, held his hand, kissed him, asked for forgiveness and then left a note and pipe bomb next to the body.

Castillo later dressed in a Colorado T-shirt, a black trench coat he bought during a sightseeing trip to Columbine, cargo pants, military-style boots and ammunition belts, according to testimony. He armed himself with a sawed-off shotgun he named Arlene, the same name Columbine shooter Eric Harris gave his gun, he wrote in his journal.  Watch how Castillo named his guns »

He also carried a 9 mm semi-automatic rifle he named Anna after an unrequited high school crush. He gathered pipe bombs, smoke grenades and nearly 200 rounds of ammunition.

Before leaving for Orange High School, Castillo sent an e-mail to the principal of Columbine High School in Littleton, Colorado, to alert him that Hillsborough would soon make history, according to testimony. He also mailed a letter and videos to a classmate and a local newspaper.

Castillo drove the family's minivan to a patio lunch area, set off a cherry bomb and fired at the students. He later told a psychiatrist that he aimed for their heads, according to testimony. His gun jammed, and he was jumped by a deputy sheriff assigned to the school and a retired highway patrol officer who taught driver's education

Castillo's trial included eight hours of homemade videos showing Castillo ranting, yelling, whispering, singing and beating himself; journal entries detailing an obsession with a classmate he compared to the obsession would-be presidential assassin John Hinckley had with Jodie Foster; and a notebook he called "Mass Murders and School Shootings of the 20th and 21st Centuries."  See excerpts of Castillo's journal »

In the notebook, he listed himself at the end of a gallery of school shooters.

Jurors also saw a narrated video that Castillo shot in Littleton after convincing his mother to take him there to see Columbine High School and the homes of shooters Eric Harris and Dylan Klebold.

Castillo's mother and sister, both named Victoria, testified that Rafael Castillo tormented the family. He was described as a controlling husband and father with unconventional beliefs. They said he forbid his wife from bathing the children in warm water because he believed cold water cured all ills. The children often saw their father drag their mother by her hair, according to testimony.  Watch Castillo's mother describe the abuse »

After high school graduation in 2005, Castillo enlisted in the National Guard. By January 2006 he decided to kill himself. He was discharged from the National Guard later that year.

In April 2006 Castillo recorded a video in which he appears to be talking to his unrequited crush. He asked his father to mail the video on April 20. When Rafael Castillo returned, his son was dressed in his military uniform and was close to shooting himself with a shotgun, according to testimony. Rafael Castillo wrestled the gun away and called the police on his son, who was committed to a psychiatric facility.

When Castillo was discharged a week later, he was advised not to have contact with guns and placed on an antidepressant. But five days after his discharge Castillo bought another shotgun. His journal shows that he had decided to carry out a "Columbine-like massacre at Orange High School."

By late June, he told his therapists that he no longer felt suicidal or thought of hurting others, and that he was no longer obsessed with Columbine.

From June 1 to August 30, Castillo's diary is replete with references to "Operation Columbine" and how he would "sacrifice" students then kill himself. He chose August 30 because it is the birthday of Kip Kinkel, another high school shooter who killed his parents and high school students in 1998 in Springfield, Oregon.

Defense attorney Williams told the jury that a social worker tried urgently to get Castillo into treatment in July, but there was a six-week backlog at the local psychiatric clinic. She tried to get another clinic to see him, but learned on August 11 that they would not.

Nineteen days later, Castillo shot his father dead, dressed in the manner of the Columbine shooters, drove to his alma mater and opened fire.

@highlight

Alvaro Castillo, 21, sentenced to life without parole

@highlight

Castillo shot father, opened fire at former high school on August 20, 2006

@highlight

Trial featured disturbing videos, journal entries

@highlight

Castillo was obsessed with the Columbine shootings