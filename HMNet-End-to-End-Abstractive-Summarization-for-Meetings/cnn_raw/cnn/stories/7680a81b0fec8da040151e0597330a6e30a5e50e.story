Charges have been filed against a now-former sheriff's deputy in upstate New York after an online video showed him cursing and acting aggressively toward a man who didn't want his car searched, according to a Monday press release from the Saratoga County Sheriff's Office.

Shawn R. Glans was charged with official misconduct and second-degree harassment, said Saratoga County Sheriff Michael H. Zurlo.

Glans, who resigned from the force, was released on his own recognizance, Zurlo said.

The video shows the deputy cursing at the man, who repeatedly tells the officer there's no reason to search the vehicle.

"I wasn't in my car when all this was happening," the man says. "Why don't you want to search like my house or something?"

"Let me see your f***ing keys," the deputy fires back. The video shows the deputy approaching the man. "You want to f***ing resist?" the deputy says.

"I'm not resisting," the man says. Then there's the sound of a slap.

The video, which has been viewed thousands of times on YouTube, doesn't show the source of the sound. The man who says he recorded the video told CNN affiliate WTEN that the officer hit the man.

"He gave him a good whack on the back of the head, and after that he got the keys," the man said. "I just thought it was really wrong, the way he went about it."

The deputy also had harsh words apparently aimed at the man recording the video, telling him, "I'll rip your f***ing head off."

The press release from the sheriff said: "The actions of Sergeant Glans both as a police officer and a supervisor were completely inappropriate and unwarranted and not condoned in any fashion by the Saratoga County Sheriff's Office. His actions served no purpose in the furtherance of the investigation that he was conducting and have greatly undermined the public trust of this agency."

The Saratoga County Sheriff's Department said the incident occurred after "a suspicious vehicle complaint" early Friday in the town of Halfmoon, New York.

Cop's choke hold killed NY man

@highlight

Now-former deputy Shawn R. Glans was charged with official misconduct, harassment

@highlight

The video shows the deputy cursing at a man who doesn't want his car searched

@highlight

Saratoga County Sheriff Michael Zurlo said Glans resigned from the force

@highlight

The man who recorded the video tells WTEN the officer hit the man