Kabul, Afghanistan (CNN) -- The guard who killed the half-brother of Afghan President Hamid Karzai, had for years worked with International Security Assistance Forces against Taliban militants, according to three local officials with direct knowledge of the dealings.

Sardar Mohammed, who authorities say shot and killed Kandahar's provincial council chief Ahmed Wali Karzai, received training from ISAF and participated in intelligence gathering against militants across the region, according to Besmellah Afghanmal, a provincial council member with close ties to the Karzai family.

He "was one of the trusted commanders for the Karzais," Afghanmal told CNN. "Sardar Mohammad was working with American Special Forces closely and he was participating in many operations with American Special forces against the Taliban in (the) south."

Others, like provincial parliament member Hashim Watanwal, say Mohammad had worked with both U.S. and Canadian forces in Kandahar -- an ethnically Pashtun dominated region long-considered the Taliban heartland.

Baz Mohammed, a Kandahar tribal elder with close connections to the Karzai clan, said the guard was "a trustworthy person" who collaborated regularly with ISAF in Kandahar.

An ISAF spokeswoman declined to comment on the claims.

Though suspected of corruption and opium dealing, Wali Karzai was considered a major power-broker in Afghanistan's restive south and a bulwark for his brother against the Taliban militancy.

His death Tuesday sent shock-waves across Afghanistan's political landscape, and prompted President Karzai to weep as mourners gathered for his half-brother's burial the following day.

Saidkhan Khakrezwal, a member of the Kandahar provincial council, said he and others were with Wali Karzai when the guard came into the room and asked to talk to him.

The guard took "Wali to another room and shoots him with a pistol that he had in his hand," Khakrezwal said.

Local authorities say the shooter was then shot dead by other guards.

The Taliban soon claimed responsibility for the shooting, saying Mohammed had been working for them.

It is not clear whether the guard had been a member of a Taliban sleeper cell or if the killing was motivated by some other factor.

On Thursday, in a brazen strike illustrating the power and reach of Afghan militants, a suicide bomber slipped into a Kandahar mosque and killed at least six people, wounding 15 others.

The attack occurred as several high-ranking Afghan officials gathered to remember Wali Karzai.

CNN's Faizel Reshad contributed to this report

@highlight

Sardar Mohammed for years worked against Taliban militants, according to three local officials

@highlight

He worked with both U.S. and Canadian forces in Kandahar, an official said

@highlight

Sardar Mohammed shot and killed Kandahar's provincial council chief Ahmed Wali Karzai, police say

@highlight

Wali Karzai was the half-brother of Afghan President Hamid Karzai