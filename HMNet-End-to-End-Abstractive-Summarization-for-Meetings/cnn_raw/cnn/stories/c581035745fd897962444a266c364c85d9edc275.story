(CNN) -- The gunmen came in during noon prayers at the small Sunni mosque in the Diyala province, waving AK-47 machine guns.

Then they opened fire, the sound of the gunfire carried over the mosque's loudspeakers that seconds earlier had been broadcasting prayers.

When the bullets stopped flying at the Musab bin Omar Mosque in the village of Bani Weis, about 75 kilometers (46 miles) northeast of Baquba, 34 people were dead and a more than a dozen were wounded.

Now, a report released Sunday by Human Rights Watch, citing witnesses and survivors of the August 22 attack, points the finger at Shiite militias and Iraqi security forces.

Victims of the massacre "by Iraqi pro-government militias and security forces recognized the attackers and knew them by name," the report said. Some wore Iraqi police uniforms, according to the report.

The rights group called on the government to make public details of its findings into the attack, which HRW said was consistent with a pattern of killings being carried out in Iraq by Shiite militias, including al Haq, the Badr Brigades and Kataib Hezbollah.

"Pro-government militias are becoming emboldened and their crimes more shocking," said Joe Stork, deputy Middle East director at HRW.

"Iraqi authorities and Iraq's allies alike have ignored this horrific attack and then they wonder why the militant group Islamic State has had such appeal among Sunni communities."

HRW called on the United States and its allies to stop providing Iraq "with military support and assistance until the government ensures that such widespread war crimes and crimes against humanity have ended," the rights group said.

Complicated strategic situation

It's unlikely that will occur as the United States and a host of allies have been providing military support to Iraq in its effort to take back wide swaths of land seized by ISIS, the militant group that refers to itself as the Islamic State.

The attack made international headlines after Sunni lawmakers in Iraq withdrew from negotiations to form a new government, saying they would not return until those behind the attack were arrested. Initial reports said 65 people were killed. The figure was later revised to 34.

But the U.S. State Department called on the lawmakers to return to negotiations, saying they needed to take steps to unify the country, not divide it further.

Iraq's government formed an investigative committee, but according to HRW, the findings have not been made public nor have they been shared with the survivors or the victims' families.

According to the report, a spokesman for the Ministry of Interior told HRW that it had formed a commission to investigate the attack, and the commission had determined three suspects carried out the killings.

Authorities told HRW the attack on the mosque appeared to be retaliation for a roadside bomb explosion earlier in the day that targeted volunteer Shiite fighters on their way into Bani Weis.

Ministry officials did not immediately respond to a CNN request for comment.

'Don't move. No one leave'

The accounts offered by survivors and witnesses to HRW paint a terrifying picture of what unfolded inside the mosque on August 22.

"Don't move. No one leave," a gunman wearing a dark green T-shirt and a headband typically worn by militiamen affiliated with Asaib al-Haq, the survivor said.

"He aimed his first shot at the sheikh, and then he continued shooting the rest of us. When I heard the first gunshot, I dropped to the ground," the survivor said.

The survivor, who was not identified by HRW over safety concerns, was one of the lucky ones.

The attack, according to witnesses, was carried out in two stages, with gunmen opening fire inside the mosque and then shooting would-be rescuers outside.

"The witnesses said there was an army checkpoint about 200 meters (656 feet) from the mosque and a police checkpoint about 150 meters from the mosque, but that no security forces responded to the attack even though the shooting was broadcast over the mosque loudspeaker," the report said.

Witnesses testified the shooting carried over the loudspeaker could be heard at a distance of at least 600 meters (1,969 feet), it said.

CNN's Jomana Karadsheh contributed to this report.

@highlight

Human Rights Watch report finds Shiite militia behind the massacre at a mosque

@highlight

The report also said Iraqi security forces, believed to be police, were involved

@highlight

Witnesses and survivors said they recognized the gunmen

@highlight

34 people were killed and more than a dozen wounded in the mosque attack